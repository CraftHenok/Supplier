<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit"
	xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="new-test-suite.xml" />
	<munit:test name="accountalignmentintegration-oracleFlowTest"
		description="Test" doc:id="e274214b-38a0-4f6c-ace7-dc8bbe04e5f8">
		<munit:behavior>
			<munit-tools:mock-when doc:name="Mock Supplier SP"
				doc:id="9b186949-e30f-4ad7-b9dc-5bb23e2cd4e9" processor="db:stored-procedure">
				<munit-tools:with-attributes>
					<munit-tools:with-attribute
						attributeName="doc:name" whereValue="Call Supplier Stored Procedure" />
				</munit-tools:with-attributes>
				<munit-tools:then-return>
					<munit-tools:payload
						value='#[%dw 2.0
output application/java
---
{
	xrefSFsuppsiteIndigoID: 1,
	xrefSFsuppsiteIndigoIDDiff: "N"
}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Sites SP"
				doc:id="62d56f1d-3cb4-41f9-ac49-c671ff021159" processor="db:stored-procedure">
				<munit-tools:with-attributes>
					<munit-tools:with-attribute
						attributeName="doc:name" whereValue="Stored procedure" />
				</munit-tools:with-attributes>
				<munit-tools:then-return>
					<munit-tools:payload
						value='#[%dw 2.0
output application/java
---
{
	xrefSFsuppsiteIndigoID: 1,
	xrefSFsuppsiteIndigoIDDiff: "N"
}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Send Email"
				doc:id="0d744048-2099-4443-954a-54d0f332e77c" processor="email:send">
				<munit-tools:then-return>
					<munit-tools:payload value="#['sent']" />
				</munit-tools:then-return>
			</munit-tools:mock-when>

		</munit:behavior>
		<munit:execution>
			<flow-ref doc:name="accountalignmentintegration-oracleFlow"
				doc:id="ad5e38af-01a0-47d3-9c79-d6e276052ee3" name="accountalignmentintegration-oracleFlow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-that doc:name="Assert that payload is not null"
				doc:id="e7d94306-f808-47b1-a024-f34421090b3f" expression="#[payload]"
				is="#[MunitTools::notNullValue()]" />
		</munit:validation>
	</munit:test>

	<munit:test name="accountalignmentintegration-send-email-oracleFlowTest"
		description="Test" doc:id="ec82625d-3fc9-46d5-a089-13b9a1b705b8">
		<munit:behavior>
			<munit-tools:mock-when doc:name="Mock Supplier SP"
				doc:id="477972f3-02d2-448a-9ab1-226a2bd7a81c" processor="db:stored-procedure">
				<munit-tools:with-attributes>
					<munit-tools:with-attribute
						attributeName="doc:name" whereValue="Call Supplier Stored Procedure" />
				</munit-tools:with-attributes>
				<munit-tools:then-return>
					<munit-tools:payload
						value='#[%dw 2.0
output application/java
---
{
	xrefSFsuppsiteIndigoID: 1,
	xrefSFsuppsiteIndigoIDDiff: "Y"
}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Sites SP"
				doc:id="2c3a6348-634b-423d-9695-4bd0fae21bea" processor="db:stored-procedure">
				<munit-tools:with-attributes>
					<munit-tools:with-attribute
						attributeName="doc:name" whereValue="Stored procedure" />
				</munit-tools:with-attributes>
				<munit-tools:then-return>
					<munit-tools:payload
						value='#[%dw 2.0
output application/java
---
{
	xrefSFsuppsiteIndigoID: 1,
	xrefSFsuppsiteIndigoIDDiff: "Y"
}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Send Email"
				doc:id="7bb40bf6-04a7-493f-95f0-1d452b33007b" processor="email:send">
				<munit-tools:then-return>
					<munit-tools:payload value="#['sent']" />
				</munit-tools:then-return>
			</munit-tools:mock-when>

		</munit:behavior>
		<munit:execution>
			<flow-ref doc:name="accountalignmentintegration-oracleFlow"
				doc:id="cf049cd9-7113-47fa-9fe2-c97cd1e33e91" name="accountalignmentintegration-oracleFlow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-that doc:name="Assert that payload is not null"
				doc:id="3e700067-7e85-4591-9f88-8eb92701aac2" expression="#[payload]"
				is="#[MunitTools::notNullValue()]" />
		</munit:validation>
	</munit:test>



</mule>
